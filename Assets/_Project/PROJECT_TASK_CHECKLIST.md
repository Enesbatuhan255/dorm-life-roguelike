# DormLifeRoguelike - Project Checklist

## Completed
- [x] Core service layer (`IService`, `ServiceLocator`, `GameBootstrap`)
- [x] Stat system (`IStatSystem`, `StatSystem`, stat events/types)
- [x] Time system (`ITimeManager`, `TimeManager`, time events)
- [x] Event vertical slice (`IEventManager`, `EventManager`, event data models)
- [x] Domain reload safe startup/reset in bootstrap
- [x] Event debug runner added (`EventDebugRunner`)
- [x] Event flow converted to push + queue model
- [x] Event UI presenter implemented (`EventPanelPresenter`)
- [x] Scene UI wired (`EventCanvas`, `EventPanel`, choice buttons, outcome text)
- [x] Input System compatibility fixes for UI/Event trigger
- [x] Stat HUD presenter added and wired (`StatHudPresenter`)
- [x] Choice apply path validated with runtime logs
- [x] Event scheduler service started (`IEventScheduler`, `EventScheduler`)
- [x] Production event pool assets created and assigned to `GameBootstrap.scheduledEvents`
- [x] Weighted/random event selection implemented in scheduler
- [x] Scheduler checks on day change (`ITimeManager.OnDayChanged`)
- [x] Action buttons (`Study`, `Sleep`, `Work`) added with stat + time effects
- [x] SleepDebt values moved to `SleepDebtConfig` ScriptableObject and wired in bootstrap
- [x] SleepDebt system integrated (night accumulation, sleep suppression, action multipliers)
- [x] Economy MVP integrated (`IEconomySystem`, daily costs, action transactions)
- [x] Transaction feed UI added (last 5 economy transactions)
- [x] Day-change popup added with daily-cost summary
- [x] Queue policy added (dedupe + max pending size = 5)
- [x] Event stable ID flow added (`eventId`, OnValidate checks, duplicate scheduled ID warning)
- [x] Event Audit tool added (audit + auto-fix missing IDs + CSV export)
- [x] Mini win/lose condition system added (`IGameOutcomeSystem`, `GameOutcomeSystem`, day-based evaluation)
- [x] Outcome flow moved to config (`GameOutcomeConfig` ScriptableObject + fail priority)
- [x] Canonical outcome config asset created and assigned (`Assets/_Project/ScriptableObjects/Config/GameOutcomeConfig.asset`)
- [x] GameOver/Pass full-screen panel added (`GameOutcomePanelPresenter`)
- [x] Action pipeline hardened after resolve (actions are no-op when game outcome is resolved)
- [x] Regression tests added (`OnGameEnded` single-fire + resolved-after-action no-op)
- [x] PlayMode sanity script added (`Tools/mcp/playmode_sanity_check.ps1`)
- [x] Scheduler/Queue regression tests expanded (active same-ID dedupe, shared cooldown key, all-ineligible no-queue)
- [x] `_Project` regression stabilization gate passed (2 consecutive clean EditMode runs in `DormLifeRoguelike.Tests.EditMode`)
- [x] Event category/context filter hardening completed (stat-tag fail-closed when scheduler has no stat service)
- [x] Event scheduler policy tests expanded for category/context filter edge cases
- [x] Event chain/follow-up repeat policy implemented (same follow-up is processed for each trigger)
- [x] Event scheduler policy tests expanded for repeated immediate/delayed follow-up scenarios
- [x] Wave 1 choice-depth rollout completed for 16 high-impact events (Major>=3, Minor>=2)
- [x] Choice coverage validator + CSV report pipeline added (`EventChoiceCoverageValidator`, `event_choice_coverage_report.csv`)
- [x] Event chain graph exporter added (`EventChainGraphReport`, `event_chain_graph.csv`)
- [x] Chain integrity and Wave 1 choice policy regression tests added
- [x] Wave 2 choice-depth rollout completed for remaining 12 production events
- [x] Global choice policy gate reached for production EventData (Major>=3, Minor>=2 for 28/28)
- [x] Choice `flags` runtime state service added (`IFlagStateService`, `FlagStateService`)
- [x] Daily flag-driven rule engine added (`IFlagRuleService`, `FlagRuleService`)
- [x] Flag application regression tests added (`EventFlagStateTests`, `FlagRuleServiceTests`)
- [x] Stabilization baseline lock refreshed (`DormLifeRoguelike.Tests.EditMode` + `DormLifeRoguelike.Tests.PlayMode`)
- [x] Gameplay test gate finalized as namespace-scoped acceptance (`DormLifeRoguelike.Tests.*`)
- [x] Production EventData category/context tuning pass completed (weights + requiredContextTags)
- [x] PlayMode coverage expanded for scheduler critical flows (delayed follow-up, chain repeat, context tags)
- [x] Save/Load snapshot schema expanded to runtime systems (EventManager queue, EventScheduler state, GameOutcome state)
- [x] Snapshot migration bumped to schema v2 with backward-compatible defaults
- [x] `EventScheduler` split into partials (`EventScheduler.cs` + `EventScheduler.FollowUpsAndState.cs`) for maintainability
- [x] `ActionPanelPresenter` split into partials (`ActionPanelPresenter.cs` + `.Ui` + `.Interactive`)
- [x] `MicroChallengePanelPresenter` split into partials (`MicroChallengePanelPresenter.cs` + `.Ui`)
- [x] Stat HUD readability polish applied (`StatHudPresenter`: risk tags + color-coded values + improved formatting)
- [x] No-space path migration toolkit added (`migrate_project_path_no_spaces.ps1` + runbook + dry-run validated)
- [x] Project path migrated to no-space folder and MCP stability re-validated (`C:\DormLifeRoguelike\MyProject`)
- [x] PlayMode context-tag coverage test made deterministic (removed weighted-random flake path)

## In Progress
- [ ] Tune cooldown/category/queue policy based on focused playtests
- [ ] Continue UI maintainability pass (shared UI builder/helpers for panel presenters)

## Next
- [ ] Add richer HUD visuals (icons/mini-bars) if art direction allows
- [ ] Refactor large classes (`ActionPanelPresenter`, `EventScheduler`, `MicroChallengePanelPresenter`)
